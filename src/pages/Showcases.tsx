import { motion } from 'framer-motion'
import { useState, useEffect } from 'react'
import '../App.css'

export function Showcases() {
  const [codeModal, setCodeModal] = useState<{ isOpen: boolean; code: string; title: string; workflow: string[] }>({
    isOpen: false,
    code: '',
    title: '',
    workflow: []
  })
  const [workflowExpanded, setWorkflowExpanded] = useState(false)

  // Scroll to top when component mounts
  useEffect(() => {
    window.scrollTo({ top: 0, behavior: 'instant' })
  }, [])

  const openCodeModal = (code: string, title: string, workflow: string[]) => {
    setCodeModal({ isOpen: true, code, title, workflow })
    setWorkflowExpanded(false)
  }

  const closeCodeModal = () => {
    setCodeModal({ isOpen: false, code: '', title: '', workflow: [] })
    setWorkflowExpanded(false)
  }

  return (
    <div className="container">
      {/* Code Modal */}
      {codeModal.isOpen && (
        <div 
          className="lightbox" 
          onClick={closeCodeModal}
          style={{ zIndex: 1000 }}
        >
          <div 
            className="lightbox-content" 
            onClick={(e) => e.stopPropagation()}
            style={{ 
              width: '90vw',
              maxWidth: '900px', 
              maxHeight: '90vh', 
              overflow: 'auto' 
            }}
          >
            <button className="lightbox-close" onClick={closeCodeModal}>
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
            <h3 style={{ marginTop: 0 }}>{codeModal.title}</h3>
            <details 
              open={workflowExpanded}
              onClick={(e) => {
                e.preventDefault()
                setWorkflowExpanded(!workflowExpanded)
              }}
              style={{ 
                marginBottom: '1rem',
                background: 'rgba(var(--pico-primary-rgb), 0.05)',
                padding: '0.75rem',
                borderRadius: 'var(--pico-border-radius)',
                borderLeft: '3px solid var(--pico-primary)'
              }}
            >
              <summary 
                className="modal-workflow-summary"
                style={{ 
                  cursor: 'pointer',
                  fontSize: '0.9rem',
                  fontWeight: 600,
                  display: 'flex',
                  alignItems: 'center',
                  gap: '0.5rem'
                }}
              >
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                  <polyline points="9 11 12 14 22 4"></polyline>
                  <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                </svg>
                How This Was Generated
                <svg 
                  width="16" 
                  height="16" 
                  viewBox="0 0 24 24" 
                  fill="none" 
                  stroke="currentColor" 
                  strokeWidth="2"
                  style={{ 
                    marginLeft: 'auto',
                    transform: workflowExpanded ? 'rotate(0deg)' : 'rotate(-90deg)',
                    transition: 'transform 0.2s ease'
                  }}
                >
                  <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
              </summary>
              <ol style={{ 
                margin: '0.75rem 0 0 0', 
                paddingLeft: '1.5rem', 
                lineHeight: '1.8',
                fontSize: '0.85rem',
                color: 'var(--pico-muted-color)'
              }}>
                {codeModal.workflow.map((step, idx) => (
                  <li key={idx} dangerouslySetInnerHTML={{ __html: step }} />
                ))}
              </ol>
            </details>
            <pre style={{ 
              background: 'var(--pico-code-background-color)', 
              padding: '1rem', 
              borderRadius: 'var(--pico-border-radius)',
              overflow: 'auto',
              fontSize: '0.85rem',
              lineHeight: '1.5'
            }}>
              <code>{codeModal.code}</code>
            </pre>
          </div>
        </div>
      )}

      <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ duration: 0.5 }}
      >
        <section id="showcases-header" style={{ textAlign: 'center', padding: 'calc(var(--pico-spacing) * 2) 0' }}>
          <h1>Built with DAML Autopilot</h1>
          <p style={{ maxWidth: '800px', margin: '0 auto', fontSize: '1.125rem', color: 'var(--pico-muted-color)' }}>
            These complete DAML applications were generated by our MCP tools in a single chat session. 
            They showcase the quality, completeness, and production-readiness of AI-assisted development with DAML Autopilot.
          </p>
          <div style={{ 
            maxWidth: '700px', 
            margin: '1.5rem auto 0 auto', 
            padding: '1rem', 
            background: 'rgba(var(--pico-primary-rgb), 0.1)', 
            borderRadius: 'var(--pico-border-radius)',
            border: '1px solid rgba(var(--pico-primary-rgb), 0.2)'
          }}>
            <p style={{ fontSize: '0.95rem', marginBottom: '0.5rem', fontWeight: 600 }}>
              üí¨ Generated in Agent Mode
            </p>
            <p style={{ fontSize: '0.9rem', margin: 0, lineHeight: 1.6 }}>
              Each example was created by asking the AI agent to "build a [concept] application on Canton." 
              The agent used DAML Reason for code analysis, DAML Automater for setup, and produced 
              complete, tested, documented applications ready to deploy.
            </p>
          </div>
          <a href="#home" role="button" className="outline" style={{ marginTop: '1.5rem', display: 'inline-block' }}>
            ‚Üê Back to Home
          </a>
        </section>

        <section id="asset-swap">
          <article className="demo-card">
            <header>
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap', gap: '1rem' }}>
                  <div>
                    <h2 style={{ margin: 0 }}>Asset Swap Application</h2>
                    <small style={{ color: 'var(--pico-muted-color)' }}>Generic atomic swaps for any DAML contract</small>
                  </div>
              </div>
            </header>
            
            <div style={{ 
              padding: '0.75rem', 
              marginBottom: '1rem',
              background: 'rgba(var(--pico-primary-rgb), 0.08)',
              borderRadius: 'var(--pico-border-radius)',
              borderLeft: '3px solid var(--pico-primary)'
            }}>
              <p style={{ fontSize: '0.9rem', margin: 0, fontStyle: 'italic' }}>
                <strong>Prompt:</strong> "Build a flexible asset swap application on Canton."
              </p>
            </div>
            
            <p>
              A flexible, production-ready system for swapping assets by their Contract IDs. 
              Supports two-party swaps, multi-asset exchanges, and complex multi-party agreements with built-in dispute resolution.
            </p>

            <div className="grid" style={{ marginBottom: '1rem' }}>
              <div>
                <strong>‚úì Generic & Type-Agnostic</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Swap any DAML contract: Bonds, Tokens, NFTs, or custom assets
                </p>
              </div>
              <div>
                <strong>‚úì Atomic Agreements</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Both parties must approve before execution
                </p>
              </div>
              <div>
                <strong>‚úì Multi-Party Support</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Complex swaps with 3+ participants
                </p>
              </div>
              <div>
                <strong>‚úì Dispute Resolution</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Built-in workflow for handling issues
                </p>
              </div>
            </div>

            <details>
              <summary>View Code Example</summary>
              <figure style={{ marginTop: '1rem' }}>
                <figcaption>Creating a swap proposal</figcaption>
                <pre style={{ fontSize: '0.85rem' }}><code>{`-- Define assets to swap
let myBond = AssetDescription with
      contractId = show bondCid
      assetType = "Bond"
      description = "5% Bond $100k"
      quantity = Some 100000.0

let theirTokens = AssetDescription with
      contractId = show tokenCid
      assetType = "Token"
      description = "1000 Premium Tokens"
      quantity = Some 1000.0

-- Create swap proposal
swapCid <- submit alice do
  createCmd SwapProposal with
    proposer = alice
    counterparty = bob
    proposerAssets = [myBond]
    counterpartyAssets = [theirTokens]
    swapId = "SWAP-001"
    description = "Bond for tokens"

-- Bob accepts the swap
agreementCid <- submit bob do
  exerciseCmd swapCid AcceptSwap

-- Execute transfers & complete
completionCid <- submit alice do
  exerciseCmd agreementCid CompleteSwap
    with completedBy = alice`}</code></pre>
              </figure>
            </details>

            <details>
              <summary>View Available Test Scripts</summary>
              <div style={{ padding: '1rem' }}>
                <ul style={{ fontSize: '0.9rem', lineHeight: '1.8' }}>
                  <li><code>testBondSwap</code> - Simple two-party bond exchange ‚úÖ</li>
                  <li><code>testMultiAssetSwap</code> - 2-for-1 multi-asset swap ‚úÖ</li>
                  <li><code>testSwapModification</code> - Update and cancel proposals ‚úÖ</li>
                  <li><code>testSwapDispute</code> - Dispute resolution workflow ‚úÖ</li>
                </ul>
                <pre style={{ fontSize: '0.85rem', marginTop: '0.5rem' }}><code>{`daml script --dar .daml/dist/*.dar \\
  --script-name AssetSwapSetup:testBondSwap`}</code></pre>
              </div>
            </details>

            <footer style={{ marginTop: '1.5rem', textAlign: 'center' }}>
              <button 
                onClick={() => openCodeModal(
                  `-- Asset Swap Application
-- Generic atomic swaps for any DAML contract type

module AssetSwap where

import DA.Optional

-- | Generic asset description for swap coordination
data AssetDescription = AssetDescription with
    contractId : Text
    assetType : Text
    description : Text
    quantity : Optional Decimal
  deriving (Eq, Show)

-- | Two-party swap proposal
template SwapProposal
  with
    proposer : Party
    counterparty : Party
    proposerAssets : [AssetDescription]
    counterpartyAssets : [AssetDescription]
    swapId : Text
    description : Text
    expirationDate : Optional Text
  where
    signatory proposer
    observer counterparty
    
    ensure length proposerAssets > 0 
      && length counterpartyAssets > 0
    
    choice AcceptSwap : ContractId SwapAgreement
      controller counterparty
      do
        create SwapAgreement with
          party1 = proposer
          party2 = counterparty
          party1Assets = proposerAssets
          party2Assets = counterpartyAssets
          swapId; description
          status = "Pending"
    
    choice CancelSwap : ()
      controller proposer
      do return ()
    
    choice UpdateSwap : ContractId SwapProposal
      with
        newProposerAssets : [AssetDescription]
        newCounterpartyAssets : [AssetDescription]
        newDescription : Text
      controller proposer
      do
        create this with
          proposerAssets = newProposerAssets
          counterpartyAssets = newCounterpartyAssets
          description = newDescription

-- | Agreed swap awaiting execution
template SwapAgreement
  with
    party1 : Party
    party2 : Party
    party1Assets : [AssetDescription]
    party2Assets : [AssetDescription]
    swapId : Text
    description : Text
    status : Text
  where
    signatory party1, party2
    
    choice CompleteSwap : ContractId SwapCompletion
      with completedBy : Party
      controller completedBy
      do
        create SwapCompletion with
          party1; party2
          party1Assets; party2Assets
          swapId; description
          completedDate = "2025-11-27"
    
    choice InitiateDispute : ContractId SwapDispute
      with disputingParty : Party; reason : Text
      controller disputingParty
      do
        create SwapDispute with
          party1; party2
          party1Assets; party2Assets
          swapId; disputingParty; reason
          resolutionStatus = "Open"

-- Full implementation: 6 templates, 200+ lines
-- All tests passing. Production-ready.`,
                  'Asset Swap - Generated DAML Code',
                  [
                    'Searched <strong>daml-finance patterns</strong> for swap coordination templates',
                    'Generated <strong>6 DAML templates</strong> (AssetSwap.daml + AssetSwapSetup.daml)',
                    '<strong>Compiled with DAML SDK</strong> ‚Üí 0 syntax errors',
                    'Ran <strong>4 test scenarios</strong> with Canton ‚Üí all passing',
                    '<strong>DAML Reason</strong> validated authorization model & security',
                    'Auto-generated <strong>documentation</strong> (README, QUICKSTART, WORKFLOW)'
                  ]
                )}
                role="button"
              >
                View Generated Code
              </button>
            </footer>
          </article>
        </section>

        <section id="fixed-rate-bond" style={{ marginTop: '3rem' }}>
          <article className="demo-card">
            <header>
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap', gap: '1rem' }}>
                <div>
                  <h2 style={{ margin: 0 }}>Fixed Rate Bond Application</h2>
                  <small style={{ color: 'var(--pico-muted-color)' }}>Complete bond lifecycle management</small>
                </div>
              </div>
            </header>
            
            <div style={{ 
              padding: '0.75rem', 
              marginBottom: '1rem',
              background: 'rgba(var(--pico-primary-rgb), 0.08)',
              borderRadius: 'var(--pico-border-radius)',
              borderLeft: '3px solid var(--pico-primary)'
            }}>
              <p style={{ fontSize: '0.9rem', margin: 0, fontStyle: 'italic' }}>
                <strong>Prompt:</strong> "Build a fixed rate bond application on Canton."
              </p>
            </div>
            
            <p>
              Full-featured fixed-rate bond implementation with issuance, trading, coupon payments, and redemption at maturity. 
              A complete reference implementation for financial instruments on DAML.
            </p>

            <div className="grid" style={{ marginBottom: '1rem' }}>
              <div>
                <strong>Issuance & Trading</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Two-party issuance workflow and secondary market trading
                </p>
              </div>
              <div>
                <strong>Coupon Automation</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Automatic coupon calculation and payment tracking
                </p>
              </div>
              <div>
                <strong>Multi-Currency</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Support for different currencies and ISIN tracking
                </p>
              </div>
              <div>
                <strong>Lifecycle Management</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Full workflow from issuance to maturity redemption
                </p>
              </div>
            </div>

            <details>
              <summary>View Code Example</summary>
              <figure style={{ marginTop: '1rem' }}>
                <figcaption>Issuing a bond</figcaption>
                <pre style={{ fontSize: '0.85rem' }}><code>{`-- Issuer creates bond issuance request
requestCid <- submit issuer do
  createCmd BondIssuanceRequest with
    issuer
    investor = investor1
    isin = "US1234567890"
    currency = "USD"
    denomination = 100000.0
    issueDate = date 2025 Jan 1
    maturityDate = date 2030 Jan 1
    couponRate = 0.05  -- 5% annual
    couponFrequency = 2  -- Semi-annual

-- Investor accepts the bond
bondCid <- submit investor1 do
  exerciseCmd requestCid AcceptIssuance

-- Issuer pays first coupon
(newBondCid, couponCid) <- submit issuer do
  exerciseCmd bondCid PayCoupon`}</code></pre>
              </figure>
            </details>

            <details>
              <summary>View Available Test Scripts</summary>
              <div style={{ padding: '1rem' }}>
                <ul style={{ fontSize: '0.9rem', lineHeight: '1.8' }}>
                  <li><code>setup</code> - Basic bond issuance</li>
                  <li><code>testBondLifecycle</code> - Full lifecycle: issue ‚Üí coupon ‚Üí trade ‚Üí coupon</li>
                </ul>
                <pre style={{ fontSize: '0.85rem', marginTop: '0.5rem' }}><code>{`daml script --dar .daml/dist/fixed-rate-bond-*.dar \\
  --script-name BondSetup:testBondLifecycle --ide-ledger`}</code></pre>
              </div>
            </details>

            <footer style={{ marginTop: '1.5rem', textAlign: 'center' }}>
              <button 
                onClick={() => openCodeModal(
                  `-- Fixed Rate Bond Application
-- Complete bond lifecycle with issuance, trading, and coupons

module FixedRateBond where

import DA.Date

-- | Fixed rate bond with full lifecycle
template Bond
  with
    issuer : Party
    investor : Party
    isin : Text
    currency : Text
    denomination : Decimal
    issueDate : Date
    maturityDate : Date
    couponRate : Decimal
    couponFrequency : Int
    nextCouponDate : Date
    outstandingPrincipal : Decimal
  where
    signatory issuer
    observer investor
    
    ensure denomination > 0.0 
      && couponRate >= 0.0 && couponRate <= 1.0
      && couponFrequency > 0
      && outstandingPrincipal > 0.0
      && maturityDate > issueDate
      && nextCouponDate <= maturityDate
    
    choice TransferBond : ContractId Bond
      with newInvestor : Party
      controller investor
      do create this with investor = newInvestor
    
    choice PayCoupon : (ContractId Bond, ContractId CouponPayment)
      controller issuer
      do
        let couponAmount = (denomination * couponRate) 
                         / (intToDecimal couponFrequency)
        let daysToAdd = 365 / couponFrequency
        let newNextCouponDate = addDays nextCouponDate daysToAdd
        
        paymentCid <- create CouponPayment with
          bond = isin; issuer; investor
          amount = couponAmount; currency
          paymentDate = nextCouponDate
        
        bondCid <- create this with
          nextCouponDate = newNextCouponDate
        
        return (bondCid, paymentCid)
    
    choice RedeemBond : ContractId BondRedemption
      controller issuer
      do
        assertMsg "Bond can only be redeemed at maturity" 
          (nextCouponDate >= maturityDate)
        create BondRedemption with
          bond = isin; issuer; investor
          amount = outstandingPrincipal
          currency; redemptionDate = maturityDate

-- Full implementation: 5 templates, 194 lines
-- All lifecycle tests passing. Production-ready.`,
                  'Fixed Rate Bond - Generated DAML Code',
                  [
                    'Analyzed <strong>daml-finance bond patterns</strong> (coupon structures, lifecycle)',
                    'Generated <strong>5 DAML templates</strong> covering full bond lifecycle',
                    '<strong>Compiled with DAML SDK</strong> ‚Üí 0 syntax errors',
                    'Ran <strong>2 test scenarios</strong> (setup + full lifecycle) ‚Üí all passing',
                    '<strong>DAML Reason</strong> validated party authorization & redemption logic',
                    'Generated <strong>Python/TypeScript clients</strong> + comprehensive docs'
                  ]
                )}
                role="button"
              >
                View Generated Code
              </button>
            </footer>
          </article>
        </section>

        <section id="asset-option" style={{ marginTop: '3rem' }}>
          <article className="demo-card">
            <header>
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', flexWrap: 'wrap', gap: '1rem' }}>
                <div>
                  <h2 style={{ margin: 0 }}>Asset Option Application</h2>
                  <small style={{ color: 'var(--pico-muted-color)' }}>Financial options for buying assets at strike prices</small>
                </div>
              </div>
            </header>

            <div style={{ 
              padding: '0.75rem', 
              marginBottom: '1rem',
              background: 'rgba(var(--pico-primary-rgb), 0.08)',
              borderRadius: 'var(--pico-border-radius)',
              borderLeft: '3px solid var(--pico-primary)'
            }}>
              <p style={{ fontSize: '0.9rem', margin: 0, fontStyle: 'italic' }}>
                <strong>Prompt:</strong> "Build a template that allows the owner to buy assets on Canton at a strike price before a certain date."
              </p>
            </div>

            <p>
              Complete financial option implementation allowing holders to purchase assets at predetermined strike prices before expiry. 
              Supports call options, secondary market trading, and full exercise/settlement workflows.
            </p>

            <div className="grid" style={{ marginBottom: '1rem' }}>
              <div>
                <strong>‚úì Strike Price Control</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Lock in purchase price for any asset type
                </p>
              </div>
              <div>
                <strong>‚úì Expiry Management</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Time-bound options with automatic expiry enforcement
                </p>
              </div>
              <div>
                <strong>‚úì Exercise & Settlement</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Complete workflow from exercise to asset transfer
                </p>
              </div>
              <div>
                <strong>‚úì Portfolio Management</strong>
                <p style={{ fontSize: '0.9rem', margin: '0.25rem 0 0 0' }}>
                  Manage multiple options across different asset types
                </p>
              </div>
            </div>

            <details>
              <summary>View Code Example</summary>
              <figure style={{ marginTop: '1rem' }}>
                <figcaption>Creating and exercising an option</figcaption>
                <pre style={{ fontSize: '0.85rem' }}><code>{`-- Define underlying asset
let asset = AssetDetails with
      assetId = "BOND-XYZ-2030"
      assetType = "Bond"
      description = "$100k 5% Corporate Bond"
      quantity = 100000.0

-- Issuer creates option proposal
proposalCid <- submit issuer do
  createCmd AssetOptionProposal with
    issuer
    holder = investor
    underlying = asset
    strikePrice = 95000.0    -- Buy at $95k
    currency = "USD"
    expiryDate = date 2026 Jun 30
    optionType = "Call"
    premium = 5000.0         -- Pay $5k premium
    issueDate = date 2025 Nov 27

-- Investor accepts and pays premium
optionCid <- submit investor do
  exerciseCmd proposalCid AcceptOption

-- Later: Investor exercises before expiry
exerciseCid <- submit investor do
  exerciseCmd optionCid ExerciseOption with
    currentDate = date 2026 Mar 15

-- Issuer settles by transferring asset
settlementCid <- submit issuer do
  exerciseCmd exerciseCid SettleExercise with
    assetContractId = "BOND-CONTRACT-123"`}</code></pre>
              </figure>
            </details>

            <details>
              <summary>View Available Test Scripts</summary>
              <div style={{ padding: '1rem' }}>
                <ul style={{ fontSize: '0.9rem', lineHeight: '1.8' }}>
                  <li><code>setup</code> - Basic option creation and acceptance ‚úÖ</li>
                  <li><code>testOptionExercise</code> - Full exercise and settlement workflow ‚úÖ</li>
                  <li><code>testOptionExpiry</code> - Expiry enforcement validation ‚úÖ</li>
                  <li><code>testOptionPortfolio</code> - Multiple options management ‚úÖ</li>
                </ul>
                <pre style={{ fontSize: '0.85rem', marginTop: '0.5rem' }}><code>{`daml script --dar .daml/dist/*.dar \\
  --script-name AssetOptionSetup:testOptionExercise`}</code></pre>
              </div>
            </details>

            <footer style={{ marginTop: '1.5rem', textAlign: 'center' }}>
              <button 
                onClick={() => openCodeModal(
                  `-- Asset Option Application
-- Financial options for buying assets at strike prices

module AssetOption where

import DA.Date

-- | Underlying asset details
data AssetDetails = AssetDetails with
    assetId : Text
    assetType : Text
    description : Text
    quantity : Decimal
  deriving (Eq, Show)

-- | Asset Option - grants right to buy at strike price
template AssetOption
  with
    issuer : Party
    holder : Party
    underlying : AssetDetails
    strikePrice : Decimal
    currency : Text
    expiryDate : Date
    optionType : Text
    premium : Decimal
    issueDate : Date
  where
    signatory issuer, holder
    
    ensure strikePrice > 0.0 && premium >= 0.0
      && quantity underlying > 0.0
      && expiryDate > issueDate
      && (optionType == "Call" || optionType == "Put")
    
    choice ExerciseOption : ContractId OptionExercise
      with currentDate : Date
      controller holder
      do
        assertMsg "Option has expired" 
          (currentDate <= expiryDate)
        create OptionExercise with
          issuer; holder; underlying
          strikePrice; currency
          exerciseDate = currentDate
          optionType
    
    choice TransferOption : ContractId AssetOption
      with newHolder : Party
      controller holder
      do create this with holder = newHolder

-- | Exercised option awaiting settlement
template OptionExercise
  with
    issuer : Party
    holder : Party
    underlying : AssetDetails
    strikePrice : Decimal
    currency : Text
    exerciseDate : Date
    optionType : Text
  where
    signatory issuer, holder
    
    choice SettleExercise : ContractId OptionSettlement
      with assetContractId : Text
      controller issuer
      do
        create OptionSettlement with
          issuer; holder; underlying
          strikePrice; currency
          exerciseDate; assetContractId
          settlementDate = exerciseDate

-- Full implementation: 6 templates, 220+ lines
-- All test scenarios passing. Production-ready.`,
                  'Asset Option - Generated DAML Code',
                  [
                    'Searched <strong>financial option patterns</strong> (strike price, expiry enforcement)',
                    'Generated <strong>6 DAML templates</strong> (option lifecycle + settlement)',
                    '<strong>Compiled with DAML SDK</strong> ‚Üí 0 syntax errors',
                    'Ran <strong>4 test scenarios</strong> (exercise, expiry, portfolio) ‚Üí all passing',
                    '<strong>DAML Reason</strong> validated time constraints & authorization',
                    'Fixed <strong>secondary trading auth issue</strong> (iterative validation loop)'
                  ]
                )}
                role="button"
              >
                View Generated Code
              </button>
            </footer>
          </article>
        </section>

        <section style={{ textAlign: 'center', padding: 'calc(var(--pico-spacing) * 3) 0', maxWidth: '700px', margin: '0 auto' }}>
          <h3>Want to Build Your Own?</h3>
          <p style={{ color: 'var(--pico-muted-color)', marginBottom: '1.5rem' }}>
            These applications were generated in a single chat session using DAML Autopilot's MCP tools. 
            Install the MCP server and start building production-ready DAML applications with AI assistance.
          </p>
          <a 
            href="#home"
            role="button"
            className="outline"
          >
            Get Started with DAML Autopilot
          </a>
        </section>
      </motion.div>
    </div>
  )
}

