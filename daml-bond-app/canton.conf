// Canton configuration for Fixed Rate Bond Application
// This file configures a simple Canton network for testing and development

canton {
  parameters {
    manual-start = no
  }

  // Define domain (sync domain for transaction synchronization)
  domains {
    bondDomain {
      storage.type = memory
      public-api.port = 4011
      admin-api.port = 4012
    }
  }

  // Define participants
  participants {
    issuerParticipant {
      storage.type = memory
      admin-api.port = 4001
      ledger-api.port = 4002
      
      // Initial party allocation
      parties {
        Issuer = "issuer"
      }
    }

    investorParticipant {
      storage.type = memory
      admin-api.port = 4003
      ledger-api.port = 4004
      
      // Initial party allocation  
      parties {
        Investor1 = "investor1"
        Investor2 = "investor2"
      }
    }
  }

  // Bootstrap script to connect participants to domain
  bootstrap-scripts {
    enable-preview-commands = true
    
    // Connect participants to domain
    participants {
      issuerParticipant.domains.connect_local(bondDomain)
      investorParticipant.domains.connect_local(bondDomain)
    }
    
    // Upload DAR to all participants
    participants.all.dars.upload("daml-bond-app/.daml/dist/fixed-rate-bond-1.0.0.dar")
  }
}

